<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Simple Sheet Connector</title>
</head>
<body>
  <h2>Send Data to Google Sheet</h2>
  <input id="code" placeholder="Enter code" />
  <input id="value" placeholder="Enter value" />
  <button onclick="sendData()">Submit</button>

  <p id="result"></p>

  <script>
    const GOOGLE_APPS_SCRIPT_URL = "<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Simple Sheet Connector</title>
</head>
<body>
  <h2>Send Data to Google Sheet</h2>
  <input id="code" placeholder="Enter code" />
  <input id="value" placeholder="Enter value" />
  <button onclick="sendData()">Submit</button>

  <p id="result"></p>

  <script>
    const GOOGLE_APPS_SCRIPT_URL = "PASTE_YOUR_DEPLOYMENT_URL_HERE";

    async function sendData() {
      const code = document.getElementById("code").value;
      const value = document.getElementById("value").value;
      document.getElementById("result").textContent = "⏳ Sending...";

      try {
        const res = await fetch(GOOGLE_APPS_SCRIPT_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ code, value })
        });
        const text = await res.text();
        document.getElementById("result").textContent = text;
      } catch (err) {
        document.getElementById("result").textContent = "❌ Error: " + err.message;
      }
    }
  </script>
</body>
</html>
";

    async function sendData() {
      const code = document.getElementById("code").value;
      const value = document.getElementById("value").value;
      document.getElementById("result").textContent = "⏳ Sending...";

      try {
        const res = await fetch(GOOGLE_APPS_SCRIPT_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ code, value })
        });
        const text = await res.text();
        document.getElementById("result").textContent = text;
      } catch (err) {
        document.getElementById("result").textContent = "❌ Error: " + err.message;
      }
    }
  </script>
</body>
</html>
